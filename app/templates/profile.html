{% extends "base.html" %}

{% block title %}Profilul meu{% endblock %}

{% block extra_css %}
<style>
  .stats-summary {
    margin-bottom: 2rem;
  }
</style>
{% endblock %}

{% block content %}
<div class="container py-4">
  <h1 class="mb-4">Profilul lui {{ username }}</h1>

  <div class="stats-summary row">
    <div class="col-md-4">
      <div class="card text-bg-primary mb-3">
        <div class="card-header">Număr comenzi</div>
        <div class="card-body">
          <h5 class="card-title">{{ stats.total_orders }}</h5>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-bg-success mb-3">
        <div class="card-header">Valoare totală comenzi (RON)</div>
        <div class="card-body">
          <h5 class="card-title">{{ stats.total_revenue }}</h5>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-bg-info mb-3">
        <div class="card-header">Număr total produse comandate</div>
        <div class="card-body">
          <h5 class="card-title">{{ stats.total_products }}</h5>
        </div>
      </div>
    </div>
  </div>

  <h2 class="mb-3">Comenzi recente</h2>
  {% if orders %}
  <div class="table-responsive">
    <table class="table table-striped table-bordered">
      <thead class="table-dark">
        <tr>
          <th>ID Comandă</th>
          <th>Data</th>
          <th>Valoare totală (RON)</th>
          <th>Număr produse</th>
        </tr>
      </thead>
      <tbody>
        {% for order in orders %}
<tr>
  <td>{{ order.order_id }}</td>
  <td>{{ order.timestamp }}</td>
  <td>{{ order.total_price }}</td>
  <td>{{ order.total_quantity }}</td>
</tr>

<tr>
  <td colspan="4">
    <strong>Produse:</strong>
    <ul>
      {% for item in order["items"] %}
        <li>
          {{ item.name }} – {{ item.quantity }} x {{ item.price }} RON = 
          <strong>{{ item.item_total }} RON</strong>
        </li>
      {% endfor %}
    </ul>
  </td>
</tr>
{% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <p>Nu există comenzi înregistrate.</p>
  {% endif %}
</div>
{% endblock %}
